import numpy as np
import matplotlib
import matplotlib.pyplot as plt
from matplotlib import rc

x = np.array([0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1])
y_0_1 = np.array([221.65506884210123, 225.14271031080037, 227.21658670420013, 231.9698632509005, 231.2682487540998, 233.96809564460014, 236.78037629910122, 236.05425338490085, 234.1274378510993, 231.0302234272999, 231.46888528639977])
y_0_1_err = np.array([25, 26.3604, 22.4945, 25.4590, 26.2076, 28.4474, 30.7026, 30.8962, 33.4330, 36.0681, 38.866])

y_0_5 = np.array([241.61082341610057, 238.4765464079997, 242.59740283100024, 240.39797767860173, 240.7383023534001, 237.36883320030012, 239.5043688186998, 242.21967973990155, 240.15341044269968, 245.0962682306, 243.43020452579972])
y_0_5_err = np.array([47.8130, 41.3426, 42.977, 37.2745, 33.4338, 31.933, 30.0105, 37.0956, 36.47689, 47.6908, 49.2777])

y_1 = np.array([245.24792546629925, 240.13047532749934, 241.43175587880052, 240.93698301080022, 240.27094866379966, 240.00901162730088, 239.1456449512992, 243.1980364313991, 244.84244763200064, 246.08364254100047, 250.15814444900045])
y_1_err = np.array([51.7017, 46.5070, 43.8791, 37.0938, 34.8943, 31.2115, 34.3633, 36.7166, 45.2048, 49.6219, 54.03025])

matplotlib.rcParams['mathtext.fontset'] = 'dejavuserif'
matplotlib.rcParams['font.size'] = '13'
rc('text', usetex=True)
fig, ax = plt.subplots()
ax.errorbar(x-0.025, y_0_1, yerr=y_0_1_err, fmt='o', markersize=6, capsize=6, label=r"$\alpha = 0.1$")
ax.errorbar(x, y_0_5, yerr=y_0_5_err, fmt='o', markersize=6, capsize=6, label=r"$\alpha = 0.5$")
ax.errorbar(x+0.025, y_1, yerr=y_1_err, fmt='o', markersize=6, capsize=6, label=r"Risk neutral, $\alpha = 1$")
ax.set_xlabel(r"$\beta$", fontsize=14)
ax.set_ylabel(r"$f(\mathcal{S}, y)$", fontsize=14)
ax.legend()
plt.show()
